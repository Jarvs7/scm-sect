{"ast":null,"code":"import React,{useState,useContext}from\"react\";import{useNavigate}from\"react-router-dom\";import api from\"../utils/api\";import{FaEye,FaEyeSlash}from\"react-icons/fa\";import\"../styles/Login/login.css\";import{AuthContext}from\"../context/AuthContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const LoginPage=()=>{const navigate=useNavigate();const{login}=useContext(AuthContext);const[formData,setFormData]=useState({username:\"\",senha:\"\"});const[loading,setLoading]=useState(false);const[error,setError]=useState(\"\");const[showPassword,setShowPassword]=useState(false);const handleSubmit=async e=>{e.preventDefault();setLoading(true);setError(\"\");try{var _user$setor;const res=await api.post(\"/auth/login\",{username:formData.username.trim(),senha:formData.senha.trim()});const{token,user}=res.data;// Armazena no localStorage\nconsole.log('Token recebido no login:',token);localStorage.setItem(\"token\",token);localStorage.setItem(\"user\",JSON.stringify({...user,token}));console.log('Dados armazenados no localStorage:',{token:localStorage.getItem('token'),user:localStorage.getItem('user')});// Atualiza o contexto global\nlogin({...user,token});// Redirecionamento por perfil\nconst isAdmin=user.role===\"admin\";const isTransporte=((_user$setor=user.setor)===null||_user$setor===void 0?void 0:_user$setor.toLowerCase())===\"transporte\";if(isTransporte){navigate(\"/registro-viagem\");}else if(isAdmin){navigate(\"/solicitar-viagem\");}else{// Usuário comum\nnavigate(\"/solicitar-viagem\");}}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||\"Falha na conexão com o servidor\");}finally{setLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"login-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"triangles-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"triangle triangle-top-left\"}),/*#__PURE__*/_jsx(\"div\",{className:\"triangle triangle-top-right\"}),/*#__PURE__*/_jsx(\"div\",{className:\"triangle triangle-bottom-left\"}),/*#__PURE__*/_jsx(\"div\",{className:\"triangle triangle-bottom-right\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"login-box\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"login-title\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/assets/logosistema1.png\",alt:\"\\xCDcone SCM\",className:\"login-icon\",style:{width:\"48px\",height:\"48px\",marginRight:\"12px\",filter:\"drop-shadow(0 1px 1px rgba(0,0,0,0.2))\"}}),\"Login do Sistema\"]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"login-error\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",placeholder:\"Usu\\xE1rio\",className:\"login-input\",value:formData.username,onChange:e=>setFormData({...formData,username:e.target.value}),required:true,disabled:loading})}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group password-group\",children:[/*#__PURE__*/_jsx(\"input\",{type:showPassword?\"text\":\"password\",name:\"senha\",placeholder:\"Senha\",className:\"login-input\",value:formData.senha,onChange:e=>setFormData({...formData,senha:e.target.value}),required:true,disabled:loading}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"password-toggle\",onClick:()=>setShowPassword(!showPassword),disabled:loading,children:showPassword?/*#__PURE__*/_jsx(FaEyeSlash,{}):/*#__PURE__*/_jsx(FaEye,{})})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"login-button\",disabled:loading,children:loading?/*#__PURE__*/_jsx(\"span\",{className:\"loading-spinner\"}):\"Entrar\"})]})]})]})});};export default LoginPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}