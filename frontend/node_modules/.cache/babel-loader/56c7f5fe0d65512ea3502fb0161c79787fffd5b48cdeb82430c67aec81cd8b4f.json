{"ast":null,"code":"import React from'react';import{toast}from\"react-toastify\";import'../../styles/Status/status.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ViagensHoje=_ref=>{let{viagensAtivas,setViagensAtivas,loading,finalizarViagem,loadData}=_ref;const hoje=new Date();const viagensHoje=viagensAtivas.filter(viagem=>{const dataSaida=new Date(viagem.saida);return dataSaida.getDate()===hoje.getDate()&&dataSaida.getMonth()===hoje.getMonth()&&dataSaida.getFullYear()===hoje.getFullYear()&&viagem.status==='em_andamento';});const handleFinalizarViagem=async id=>{const confirm=window.confirm(\"Tem certeza que deseja finalizar esta viagem?\");if(!confirm)return;try{await finalizarViagem(id);// Atualiza o estado local primeiro para resposta rápida\nsetViagensAtivas(prevViagens=>prevViagens.filter(viagem=>viagem._id!==id));toast.success(\"Viagem finalizada com sucesso!\");// Força uma atualização completa dos dados\nawait loadData();// Isso deve recarregar motoristas, veículos e estatísticas\n}catch(error){console.error(\"Erro ao finalizar a viagem:\",error);toast.error(\"Erro ao finalizar a viagem.\");}};return/*#__PURE__*/_jsx(\"div\",{className:\"col-md-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card mb-4 shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header text-center\",children:/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-car me-2\"}),\"Viagens de Hoje\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body p-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"list-group list-group-flush\",children:viagensHoje.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-muted p-3\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-info-circle me-2\"}),\"Nenhuma viagem para hoje\"]}):viagensHoje.map(viagem=>{var _viagem$motorista,_viagem$veiculo;return/*#__PURE__*/_jsx(\"div\",{className:`viagem-card em_andamento list-group-item ${viagem.tipo==='urgente'?'urgente':''}`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-start flex-wrap\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-map-marker-alt me-2\"}),viagem.local,viagem.tipo==='urgente'&&/*#__PURE__*/_jsx(\"span\",{className:\"badge-urgente ms-2\",children:\"URGENTE\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-wrap gap-3 mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user me-2 text-muted\"}),/*#__PURE__*/_jsx(\"small\",{children:((_viagem$motorista=viagem.motorista)===null||_viagem$motorista===void 0?void 0:_viagem$motorista.nome)||\"N/A\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-car me-2 text-muted\"}),/*#__PURE__*/_jsx(\"small\",{children:((_viagem$veiculo=viagem.veiculo)===null||_viagem$veiculo===void 0?void 0:_viagem$veiculo.placa)||\"N/A\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-users me-2 text-muted\"}),/*#__PURE__*/_jsxs(\"small\",{children:[viagem.passageiros||0,\" passageiros\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-clock me-2 text-muted\"}),/*#__PURE__*/_jsx(\"small\",{children:new Date(viagem.saida).toLocaleString()})]}),viagem.observacoes&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-sticky-note me-2 text-muted\"}),/*#__PURE__*/_jsxs(\"small\",{className:\"text-muted\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Observa\\xE7\\xF5es:\"}),\" \",viagem.observacoes]})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleFinalizarViagem(viagem._id),className:\"btn btn-success btn-sm mt-2\",disabled:loading,children:[loading?/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-spinner fa-spin me-2\"}):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check me-2\"}),\"Finalizar\"]})]})},viagem._id);})})})]})});};export default ViagensHoje;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}