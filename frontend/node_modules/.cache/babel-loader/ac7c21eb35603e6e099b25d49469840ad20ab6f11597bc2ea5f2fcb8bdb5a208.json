{"ast":null,"code":"var _jsxFileName = \"D:\\\\sistema-chamados\\\\frontend\\\\src\\\\components\\\\Relatorios\\\\ExportarRelatorios.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport jsPDF from 'jspdf';\nimport autoTable from 'jspdf-autotable';\nimport { utils, writeFile } from 'xlsx';\nimport axios from 'axios';\n\n// Configuração do axios com autenticação\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst api = axios.create({\n  baseURL: process.env.REACT_APP_API_URL || 'http://localhost:1120/api',\n  timeout: 10000\n});\n\n// Interceptor para adicionar o token às requisições\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\nconst ExportarRelatorios = () => {\n  _s();\n  const [dadosRelatorios, setDadosRelatorios] = useState({\n    viagens: []\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Busca os dados do banco de dados\n  useEffect(() => {\n    const fetchDados = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        const response = await api.get('/viagens');\n        setDadosRelatorios({\n          viagens: Array.isArray(response === null || response === void 0 ? void 0 : response.data) ? response.data : []\n        });\n      } catch (error) {\n        var _error$response;\n        console.error('Erro ao buscar dados:', error);\n        if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n          // Token inválido ou expirado\n          setError('Sessão expirada. Por favor, faça login novamente.');\n          // Opcional: redirecionar para login\n          // window.location.href = '/login';\n        } else {\n          var _error$response2, _error$response2$data;\n          setError(((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || 'Erro ao carregar dados');\n        }\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchDados();\n  }, []);\n\n  // Funções de exportação (PDF e Excel) permanecem iguais\n  const exportarPDF = () => {\n    // ... (código anterior)\n  };\n  const exportarExcel = () => {\n    // ... (código anterior)\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mb-3\",\n    children: [loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-info d-flex align-items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"spinner-border spinner-border-sm me-2\",\n        role: \"status\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 11\n      }, this), \"Carregando dados...\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-danger d-flex align-items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-exclamation-triangle me-2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 11\n      }, this), error]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex gap-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: exportarPDF,\n        className: \"btn btn-danger\",\n        disabled: loading || dadosRelatorios.viagens.length === 0,\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-file-pdf me-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this), \"Exportar PDF\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: exportarExcel,\n        className: \"btn btn-success\",\n        disabled: loading || dadosRelatorios.viagens.length === 0,\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-file-excel me-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }, this), \"Exportar Excel\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 5\n  }, this);\n};\n_s(ExportarRelatorios, \"2o/K/OJhfsVIOzKHizPsZLuEWGQ=\");\n_c = ExportarRelatorios;\nexport default ExportarRelatorios;\nvar _c;\n$RefreshReg$(_c, \"ExportarRelatorios\");","map":{"version":3,"names":["React","useEffect","useState","jsPDF","autoTable","utils","writeFile","axios","jsxDEV","_jsxDEV","api","create","baseURL","process","env","REACT_APP_API_URL","timeout","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","error","Promise","reject","ExportarRelatorios","_s","dadosRelatorios","setDadosRelatorios","viagens","loading","setLoading","setError","fetchDados","response","get","Array","isArray","data","_error$response","console","status","_error$response2","_error$response2$data","message","exportarPDF","exportarExcel","className","children","role","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","length","_c","$RefreshReg$"],"sources":["D:/sistema-chamados/frontend/src/components/Relatorios/ExportarRelatorios.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\nimport { utils, writeFile } from 'xlsx';\r\nimport axios from 'axios';\r\n\r\n// Configuração do axios com autenticação\r\nconst api = axios.create({\r\n  baseURL: process.env.REACT_APP_API_URL || 'http://localhost:1120/api',\r\n  timeout: 10000\r\n});\r\n\r\n// Interceptor para adicionar o token às requisições\r\napi.interceptors.request.use(config => {\r\n  const token = localStorage.getItem('token');\r\n  if (token) {\r\n    config.headers.Authorization = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n}, error => {\r\n  return Promise.reject(error);\r\n});\r\n\r\nconst ExportarRelatorios = () => {\r\n  const [dadosRelatorios, setDadosRelatorios] = useState({ viagens: [] });\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  // Busca os dados do banco de dados\r\n  useEffect(() => {\r\n    const fetchDados = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n        \r\n        const response = await api.get('/viagens');\r\n        \r\n        setDadosRelatorios({ \r\n          viagens: Array.isArray(response?.data) ? response.data : [] \r\n        });\r\n      } catch (error) {\r\n        console.error('Erro ao buscar dados:', error);\r\n        \r\n        if (error.response?.status === 401) {\r\n          // Token inválido ou expirado\r\n          setError('Sessão expirada. Por favor, faça login novamente.');\r\n          // Opcional: redirecionar para login\r\n          // window.location.href = '/login';\r\n        } else {\r\n          setError(error.response?.data?.message || 'Erro ao carregar dados');\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchDados();\r\n  }, []);\r\n\r\n  // Funções de exportação (PDF e Excel) permanecem iguais\r\n  const exportarPDF = () => {\r\n    // ... (código anterior)\r\n  };\r\n\r\n  const exportarExcel = () => {\r\n    // ... (código anterior)\r\n  };\r\n\r\n  return (\r\n    <div className=\"mb-3\">\r\n      {loading && (\r\n        <div className=\"alert alert-info d-flex align-items-center\">\r\n          <div className=\"spinner-border spinner-border-sm me-2\" role=\"status\" />\r\n          Carregando dados...\r\n        </div>\r\n      )}\r\n      \r\n      {error && (\r\n        <div className=\"alert alert-danger d-flex align-items-center\">\r\n          <i className=\"fas fa-exclamation-triangle me-2\"></i>\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"d-flex gap-2\">\r\n        <button \r\n          onClick={exportarPDF} \r\n          className=\"btn btn-danger\"\r\n          disabled={loading || dadosRelatorios.viagens.length === 0}\r\n        >\r\n          <i className=\"fas fa-file-pdf me-2\"></i>\r\n          Exportar PDF\r\n        </button>\r\n        \r\n        <button \r\n          onClick={exportarExcel} \r\n          className=\"btn btn-success\"\r\n          disabled={loading || dadosRelatorios.viagens.length === 0}\r\n        >\r\n          <i className=\"fas fa-file-excel me-2\"></i>\r\n          Exportar Excel\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ExportarRelatorios;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}