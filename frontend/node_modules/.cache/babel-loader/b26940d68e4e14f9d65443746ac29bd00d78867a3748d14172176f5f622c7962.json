{"ast":null,"code":"import React,{useEffect,useState}from'react';import jsPDF from'jspdf';import autoTable from'jspdf-autotable';import{utils,writeFile}from'xlsx';import axios from'axios';// Configuração do axios com autenticação\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const api=axios.create({baseURL:process.env.REACT_APP_API_URL||'http://192.168.0.160:1120/api',timeout:10000});// Interceptor para adicionar o token às requisições\napi.interceptors.request.use(config=>{const token=localStorage.getItem('token');if(token){config.headers.Authorization=`Bearer ${token}`;}return config;},error=>{return Promise.reject(error);});const ExportarRelatorios=()=>{const[dadosRelatorios,setDadosRelatorios]=useState({viagens:[]});const[loading,setLoading]=useState(false);const[error,setError]=useState(null);// Busca os dados do banco de dados\nuseEffect(()=>{const fetchDados=async()=>{try{setLoading(true);setError(null);const response=await api.get('/viagens');setDadosRelatorios({viagens:Array.isArray(response===null||response===void 0?void 0:response.data)?response.data:[]});}catch(error){var _error$response;console.error('Erro ao buscar dados:',error);if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){// Token inválido ou expirado\nsetError('Sessão expirada. Por favor, faça login novamente.');// Opcional: redirecionar para login\n// window.location.href = '/login';\n}else{var _error$response2,_error$response2$data;setError(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Erro ao carregar dados');}}finally{setLoading(false);}};fetchDados();},[]);// Funções de exportação (PDF e Excel) permanecem iguais\nconst exportarPDF=()=>{// ... (código anterior)\n};const exportarExcel=()=>{// ... (código anterior)\n};return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[loading&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-info d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border spinner-border-sm me-2\",role:\"status\"}),\"Carregando dados...\"]}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-danger d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-exclamation-triangle me-2\"}),error]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:exportarPDF,className:\"btn btn-danger\",disabled:loading||dadosRelatorios.viagens.length===0,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-file-pdf me-2\"}),\"Exportar PDF\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:exportarExcel,className:\"btn btn-success\",disabled:loading||dadosRelatorios.viagens.length===0,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-file-excel me-2\"}),\"Exportar Excel\"]})]})]});};export default ExportarRelatorios;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}