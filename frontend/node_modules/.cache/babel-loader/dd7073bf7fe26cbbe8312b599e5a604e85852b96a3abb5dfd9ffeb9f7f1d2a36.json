{"ast":null,"code":"import React from'react';import{toast}from\"react-toastify\";import'../../styles/Status/status.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ViagensHoje=_ref=>{let{viagensAtivas,setViagensAtivas,loading,finalizarViagem,loadData}=_ref;const hoje=new Date();const viagensHoje=viagensAtivas.filter(viagem=>{const dataSaida=new Date(viagem.saida);return dataSaida.getDate()===hoje.getDate()&&dataSaida.getMonth()===hoje.getMonth()&&dataSaida.getFullYear()===hoje.getFullYear()&&viagem.status==='em_andamento';});const handleFinalizarViagem=async id=>{const confirm=window.confirm(\"Tem certeza que deseja finalizar esta viagem?\");if(!confirm)return;try{await finalizarViagem(id);// Atualização otimista do estado\nsetViagensAtivas(prevViagens=>prevViagens.filter(viagem=>viagem._id!==id));toast.success(\"Viagem finalizada com sucesso!\");await loadData();}catch(error){console.error(\"Erro ao finalizar a viagem:\",error);toast.error(\"Erro ao finalizar a viagem.\");// Reverter estado em caso de erro\nawait loadData();}};return/*#__PURE__*/_jsxs(\"div\",{className:\"card h-100 shadow-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header bg-primary text-white\",children:/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-car me-2\"}),\"Viagens de Hoje\",/*#__PURE__*/_jsx(\"span\",{className:\"badge bg-white text-primary ms-2\",children:viagensHoje.length})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"card-body p-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"list-group list-group-flush\",children:viagensHoje.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-muted p-4\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-info-circle me-2\"}),\"Nenhuma viagem agendada para hoje\"]}):viagensHoje.map(viagem=>{var _viagem$motorista,_viagem$veiculo;return/*#__PURE__*/_jsx(\"div\",{className:`list-group-item list-group-item-action ${viagem.tipo==='urgente'?'list-group-item-warning':''}`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-start mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-map-marker-alt text-primary me-2\"}),/*#__PURE__*/_jsxs(\"h6\",{className:\"mb-0\",children:[viagem.local,viagem.tipo==='urgente'&&/*#__PURE__*/_jsx(\"span\",{className:\"badge bg-danger ms-2\",children:\"URGENTE\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleFinalizarViagem(viagem._id),className:\"btn btn-success btn-sm\",disabled:loading,children:[loading?/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-spinner fa-spin me-1\"}):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check me-1\"}),\"Finalizar\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-wrap gap-3 mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user text-muted me-2\"}),/*#__PURE__*/_jsx(\"small\",{children:((_viagem$motorista=viagem.motorista)===null||_viagem$motorista===void 0?void 0:_viagem$motorista.nome)||\"Sem motorista\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-car text-muted me-2\"}),/*#__PURE__*/_jsx(\"small\",{children:((_viagem$veiculo=viagem.veiculo)===null||_viagem$veiculo===void 0?void 0:_viagem$veiculo.placa)||\"Sem veículo\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-users text-muted me-2\"}),/*#__PURE__*/_jsxs(\"small\",{children:[viagem.passageiros||0,\" passageiros\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-clock text-muted me-2\"}),/*#__PURE__*/_jsx(\"small\",{children:new Date(viagem.saida).toLocaleString('pt-BR',{day:'2-digit',month:'2-digit',hour:'2-digit',minute:'2-digit'})})]}),viagem.observacoes&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-light p-2 mb-0\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-sticky-note text-muted me-2\"}),/*#__PURE__*/_jsx(\"small\",{children:viagem.observacoes})]})]})]})},viagem._id);})})})]});};export default ViagensHoje;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}